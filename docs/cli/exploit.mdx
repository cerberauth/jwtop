---
title: exploit
description: Produce a JWT with a known security exploit applied.
---

# exploit

Apply a JWT security exploit to an existing token and print the modified token to stdout. Each subcommand implements one exploit independently.

> **Note:** Use only against systems you own or have explicit written permission to test.

## Usage

```sh
jwtop exploit <subcommand> <token> [flags]
```

## Subcommands

| Subcommand | Description |
|---|---|
| [`algnone`](#algnone) | Set `alg=none` and strip the signature |
| [`blanksecret`](#blanksecret) | Re-sign with an empty HMAC secret |
| [`nullsig`](#nullsig) | Strip the signature while keeping the original `alg` |
| [`hmacconfusion`](#hmacconfusion) | Re-sign with a public key as HMAC secret (RS/ES → HS) |
| [`kidinjection`](#kidinjection) | Inject a value into the `kid` header |
| [`weaksecret`](#weaksecret) | Brute-force the HMAC signing secret |

---

## algnone

Set `alg=none` and strip the signature. Use `--all` to emit one token per capitalisation variant (`none`, `NONE`, `None`, `nOnE`) to cover libraries that perform case-insensitive algorithm matching.

```sh
jwtop exploit algnone <token>
jwtop exploit algnone --all <token>
```

| Flag | Description |
|---|---|
| `--all` | Print one token per capitalisation variant of `"none"` |

---

## blanksecret

Re-sign the token with an empty string as the HMAC secret. A server that accepts this token is configured with a blank signing key.

```sh
jwtop exploit blanksecret <token>
```

---

## nullsig

Strip the signature segment while leaving the `alg` header unchanged. The resulting token has the form `header.payload.` (trailing dot, empty signature).

```sh
jwtop exploit nullsig <token>
```

---

## hmacconfusion

Re-sign an RSA or ECDSA token as its HMAC equivalent, using the server's public key PEM as the HMAC secret. Exploits servers that verify HS256 tokens using their RSA/EC public key.

Algorithm mapping (same bit-strength):

| Original | Exploited |
|---|---|
| `RS256` / `ES256` / `PS256` | `HS256` |
| `RS384` / `ES384` / `PS384` | `HS384` |
| `RS512` / `ES512` / `PS512` | `HS512` |

```sh
jwtop exploit hmacconfusion <token> --key <pem-file>
```

| Flag | Description |
|---|---|
| `--key` | Path to a PEM public key file **(required)** |

---

## kidinjection

Manipulate the `kid` header field and re-sign the token.

```sh
jwtop exploit kidinjection <token> [--mode <mode>] [--kid <value>] [--secret <secret>]
```

| Flag | Description |
|---|---|
| `--mode` | `sql`, `path`, or `raw` (default `sql`) |
| `--kid` | Override the `kid` value (overrides the mode default) |
| `--secret` | HMAC secret to sign with (overrides the mode default) |

**Modes:**

| Mode | Default `kid` | Default secret | Description |
|---|---|---|---|
| `sql` | `' UNION SELECT 'secret' FROM tokens WHERE '1'='1` | `secret` | SQL injection — makes a `SELECT` return an attacker-controlled value |
| `path` | `/dev/null` | *(empty)* | Path traversal to an empty file |
| `raw` | *(required via `--kid`)* | *(empty)* | Arbitrary value |

**Examples:**

```sh
# SQL injection (default)
jwtop exploit kidinjection --mode sql $TOKEN

# Path traversal
jwtop exploit kidinjection --mode path $TOKEN

# Arbitrary kid value
jwtop exploit kidinjection --mode raw --kid "../../etc/passwd" --secret "" $TOKEN
```

---

## weaksecret

Dictionary-attack the HMAC signing secret of an HS256/HS384/HS512 token. The built-in wordlist is tried first, then any `--wordlist` file, then any explicit `--secret` values.

```sh
jwtop exploit weaksecret <token> [--wordlist <file>] [--secret <s>...] [--workers <n>]
```

| Flag | Description |
|---|---|
| `--wordlist` | Path to a newline-delimited file of candidate secrets |
| `--secret` | Explicit candidate secret (repeatable) |
| `--workers` | Number of concurrent workers (default `8`) |

**Examples:**

```sh
# Use the built-in dictionary
jwtop exploit weaksecret $TOKEN

# Add explicit guesses on top of the built-in dictionary
jwtop exploit weaksecret $TOKEN --secret mysecret --secret topsecret

# Use a custom wordlist
jwtop exploit weaksecret $TOKEN --wordlist /path/to/secrets.txt
```

Prints the recovered secret to stdout (exit `0`) when found; exits `1` when not found.
