package cmd

import "github.com/spf13/cobra"

var exploitOtelName = "github.com/cerberauth/jwtop/cmd/exploit"

// ExploitCmd is the parent command; it prints usage when called without a subcommand.
var exploitCmd = &cobra.Command{
	Use:   "exploit <subcommand> <token>",
	Short: "Produce a JWT with a known security exploit applied",
	Long: `Apply a JWT security exploit to an existing token and print the result.

Each subcommand implements one exploit independently. Run the subcommand
without arguments to see its specific usage.

Available exploits:
  algnone        Set alg=none (and common capitalization variants)
  blanksecret    Re-sign with an empty HMAC secret
  nullsig        Strip the signature ("header.payload.")
  hmacconfusion  Re-sign with a public key as HMAC secret (RS/ES â†’ HS)
  kidinjection   Inject a value into the kid header field
  weaksecret     Brute-force the HMAC signing secret against a built-in wordlist

Exploits are derived from jwt_tool (https://github.com/ticarpi/jwt_tool)
and vulnapi (https://github.com/cerberauth/vulnapi). Use only against
systems you own or have explicit permission to test.`,
}
